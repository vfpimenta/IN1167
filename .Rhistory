car.ts
car.predict$pred
plot(car.ts, car.predict$pred, lty=1:2)
ts.plot(car.ts, car.predict$pred, lty=1:2)
predict(car.arima, n.ahead=4*12)
od = options(digits=5)
options(od)
od
auto.arima(car.ts)
auto.arima(car.ts, seasonal=FALSE)
car
tsdisplays
tsdispla
tsdisplay
car.arima = arima(car.ts, order=c(2,1,2))
car.arima
car.forecast = forecast(car.arima, h=12)
plot(car.forecast)
plot(car.forecast)
plot(car.forecast)
library(base)
length(car.ts)
9*12
car.ts
108-24
car.arima_h = arima(car.ts[-c(84,108)], order=c(2,1,2))
rm(car.predict)
car.forecast_h = forecast(car.arima_h,h=24)
plot(car.forecast_h, main=" ")
lines(car.ts)
hold = window(car.ts, start=84)
car.arima_h = arima(car.ts[-c(84,108)], order=c(2,1,2))
car.forecast_h = forecast(car.arima_h,h=24)
plot(car.forecast_h, main=" ")
lines(car.ts)
lines
plot(car.forecast_h, main=" ")
plot(car.forecast_h)
plot(car.ts)
plot(car.forecast_h)
hold = window(ts(car.ts), start=84)
car.arima_h = arima(ts(car.ts[-c(84,108)]), order=c(2,1,2))
car.forecast_h = forecast(car.arima_h,h=24)
plot(car.forecast_h, main=" ")
lines(car.ts)
png('test.png')
plot(car.forecast_h, main=" ")
lines(car.ts)
dev.off()
plot(car.forecast_h, car.ts)
plot(car.ts)
car.forecast_h
plot
plot(car.forecast_h)
lines(car.ts)
lines(car.ts)
lines(car.ts)
lines(car.ts)
lines(car.ts)
lines(car.ts)
lines(car.ts)
lines(car.ts)
lines(car.ts)
lines(car.ts)
lines(car.ts)
lines(car.ts)
lines(car.ts)
lines(car.ts)
lines(car.ts)
lines(car.ts)
lines(car.ts)
lines(car.ts)
lines(car.ts)
lines(car.ts)
lines(car.ts)
lines(car.ts)
lines(car.ts)
car.ts
plot(car.forecast)
car.arima
plot(car.ts)
plot(car.forecast)
plot(car.forecast_h)
car.forecast
car.forecast_h
car.forecast_h = ts(car.forecast_h, frequancy=12, start=c(1966,1))
car.forecast_h = ts(car.forecast_h, frequency=12, start=c(1966,1))
car.forecast_h
car.arima_h
car.forecast_h = forecast(car.arima_h, h=24)
car.forecast_h
car.forecast
car.forecast_ts = ts(car.forecast_h, frequency=12, start=c(1966,1))
car.forecast_ts
forecast
rm car.forecast_ts
rm car.forecast_ts
rm(car.forecast_ts)
car.ts
car.arima_h
car.forecast_h = forecast(car.arima_h, h=24)
car.forecast_h
car.forecast_h = forecast(car.arima_h, h=24, start=c(1966,1))
ets
car.arima
car.arima_ts
car.arima_h
7*12
car.arima_h = arima(car.ts[1:84], order=c(2,1,2))
car.arima_h
car.forecast_h = forecast(car.arima_h, h=24)
car.forecast_h
car.forecast
rm(car.arima_h)
rm(car.forecast_h)
cars
car.ts
length(car.ts)
108-24
car.ts[1:84]
ts(car.ts[1:84], start=c(1960,1), frequency=12)
car._arima = arima(ts(car.ts[1:84], start=c(1960,1), frequency=12), order=c(2,1,2))
car._arima
car._forecast = forecast(car._arima, h=24)
car._forecast
plot(car._forecast)
lines(car.ts)
png('car-forecast.png')
plot(car._forecast)
lines(car.ts)
dev.off()
png('car-forecast.png',width=860)
plot(car._forecast)
lines(car.ts)
dev.off()
auto.arima(expenses.ts, seasonal=FALSE)
expenses.arima = arima(expenses.ts, order=c(0,1,0))
expenses.forecast = forecast(expenses.arima, h=12)
plot expenses.forecast
plot(expenses.forecast)
length(expenses.ts)
expenses.ts
86-8
expenses._arima = arima(ts(expenses.ts[1:78],start=c(2009,7),frequency=12),order=c(0,1,0))
expenses._forecast = forecast(expenses._arima, h = 8)
plot(expenses._forecast)
lines(expenses.ts)
plot(car.forecast)
arima(car.ts,seasonal=FALSE)
car.ts
auto.arima(car.ts, seasonal=TRUE)
car.sarima = arima(car.ts, order = c(0,1,0), seasonal=c(0,1,1))
car.sarima
car.sarima = auto.arima(car.ts, seasonal=TRUE)
car.sforecast = forecast(car.sarima, h=12)
plot(car.sforecast)
car._sarima = auto.arima(ts(car.ts[1,84], start=c(1960,1),frequency=12),seasonal=TRUE)
car._sarima = auto.arima(ts(car.ts[1:84], start=c(1960,1),frequency=12),seasonal=TRUE)
car._sforecast = forecast(car._sarima, h=24)
plot(car._sforecast)
lines(car.ts)
png('car-seasonal-forecast.png',width=860)
plot(car._sforecast)
lines(car.ts)
dev.off()
expenses.sarima = auto.arima(expenses.ts, seasonal=TRUE)
expenses.sarima
expenses.sforecast = forecast(expenses.sarima, h=12)
plot(expenses.sforecast)
expenses._sarima = auto.arima(ts(expenses.ts[1:78],start=c(2009,7),frequency=12),seasonal=TRUE)
expenses._sforecast = forecast(expenses._sarima, h=8)
plot(expenses._sforecast)
lines(expenses.ts)
png('expenses-seasonal-forecast.png',width=860)
plot(expenses._sforecast)
lines(expenses.ts)
dev.off()
ts(expenses.ts[1:78],start=c(2009,7),frequency=12)
plot(expenses._forecast)
lines(expenses.ts)
png('expenses-forecast.png',width=860)
plot(expenses._forecast)
lines(expenses.ts)
dev.off()
acf(car.ts)
acf
acf(car.ts, lag.max=20)
acf(car.diff)
acf(car.ts)
acf(car.diff)
pacf(car.diff)
auto.arima(car.ts)
auto.arima(car.ts, seasonal=FALSE)
pacf(car.diff)
car.ar = ar(car.ts, FALSE, 0)
car.ar = ar(car.ts, FALSE, 1)
car.ar
forecast(car.ar, h = 6)
plot(forecast(car.ar, h = 6))
pacf(car.diff)
pacf(car.diff, type='correlation')
pacf(car.ts)
car.ar = ar(car.ts, FALSE, 2)
plot(forecast(car.ar, h = 6))
png('car-acf.png',width=860)
acf(car.diff)
dev.off()
png('expenses-acf.png',width=860)
acf(expenses.diff)
dev.off()
car.ar
car.ar = ar(car.ts, FALSE, 1)
expenses.ar = ar(expenses.ts, FALSE, 1)
png('car-ar-forecast.png',width=860)
plot(forecast(car.ar,h=6))
dev.off()
png('expenses-ar-forecast.png',width=860)
plot(forecast(expenses.ar,h=6))
dev.off()
arma
car.arma = arma(car.ts, order=c(0,1))
plot(forecast(car.arma, h=6))
forecast(car.arma, h=6)
car.arma
tmp.arima = arima(ts(car.ts[1,84],start=c(1960,1),frequency=12),order=c(0,1,1))
tmp.arima = arima(ts(car.ts[1:84],start=c(1960,1),frequency=12),order=c(0,1,1))
tmp.forecast = forecast(tmp.arima, h=24)
plot(tmp.forecast)
lines(car.ts)
png('car-self.forecast.png',width=860)
plot(tmp.forecast)
lines(car.ts)
dev.off()
length(expenses.ts)
tmp.arima = arima(ts(expenses.ts[1:78],start=c(2009,7),frequency=12),order=c(0,1,1))
tmp.forecast = forecast(tmp.arima, h=24)
png('expenses-self.forecast.png',width=860)
plot(tmp.forecast)
lines(car.ts)
dev.off()
tmp.forecast = forecast(tmp.arima, h=8)
png('expenses-self.forecast.png',width=860)
plot(tmp.forecast)
lines(car.ts)
dev.off()
png('expenses-self.forecast.png',width=860)
plot(tmp.forecast)
lines(expenses.ts)
dev.off()
plot(tmp.forecast)
lines(expenses.ts)
png('expenses-self.forecast.png',width=860)
plot(tmp.forecast)
lines(expenses.ts)
dev.off()
car.arma
forecast(car.arma, h=6)
q()
car
q()
library(dlm)
dlm
examples dlm
example dlm
example(dlm)
x = dlmModReg(car.ts)
x
example(dlmForecast)
mod = dlmModReg(car.ts)
fore = dlmForecast(mod, nAhead=10)
fil - dlmFilter(car.ts,mod)
fil = dlmFilter(car.ts,mod)
fore = dlmForecast(fil, nAhead=10)
car.ts
lCars <- log(cars.ts)
lCars <- log(car.ts)
lCars
dlmCars <- dlmModPoly() + dlmModSeas(4)
dlmCars
buildFun <- function(x) {
  diag(W(dlmGas))[2:3] <- exp(x[1:2])
  V(dlmGas) <- exp(x[3])
   return(dlmGas)
}
buildFun <- function(x) {
  diag(W(dlmCars))[2:3] <- exp(x[1:2])
  V(dlmCars) <- exp(x[3])
  return(dlmCars)
}
(fit <- dlmMLE(lCars, parm = rep(0, 3), build = buildFun))$conv
dlmCars <- buildFun(fir$par)
dlmCars <- buildFun(fit$par)
drop(V(dlmCars))
diag(V(dlmCars))
diag(V(dlmCars))[2:3]
carsSmooth <- dlmSmooth(lCars, mod = dlmCars)
x <- cbind(lCars, dropFirst(carsSmooth$s[,c(1,3)]))
colnames(x) <- c("Cars", "Trend", "Seasonal")
plot(x, type = 'o', main = "Monthly car sales in Quebec 1960-1968")
carsFilt <- dlmFilter(lCars, mod=dlmCars)
carsFore <- dlmForecast(carsFilt, nAhead=20)
sqrtR <- sapply(carsFore$R, function(x) sqrt(x[1,1]))
pl <- carsFore$a[,1] + qnorm(0.05, sd = sqrtR)
pu <- carsFore$a[,1] + qnorm(0.95, sd = sqrtR)
x <- ts.union(window(lCars, start = c(1960, 1)),
  window(carsSmooth$s[,1], start = c(1960, 1)),
  carsFore$a[,1], pl, pu)
plot(x, plot.type = "single", type = 'o', pch = c(1, 0, 20, 3, 3),
  col = c("darkgrey", "darkgrey", "brown", "yellow", "yellow"),
  ylab = "Log car sales")
legend("bottomright", legend = c("Observed",
  "Smoothed (deseasonalized)",
  "Forecasted level", "90% probability limit"),
bty = 'n', pch = c(1, 0, 20, 3, 3), lty = 1,
 col = c("darkgrey", "darkgrey", "brown", "yellow", "yellow"))
q()
install.packages('prophet')
library(prophet)
m = prophet(car)
car
car$y = log(car$Monthly.car.sales.in.Quebec.1960.1968)
m = prophet(car)
car$ds = car$Month
m = prophet(car)
redate <- function(x) {
  return paste(x,'01',sep="")
redate <- function(x) {
  return(paste(x,'01',sep=""))
}
car$Month
redate(car$Month)
redate <- function(x) {
  return(paste(x,'-01',sep=""))
}
car$ds <- redate(car$Month)
m = prophet(car)
future <- make_future_dataframe(m,periods=365)
future
forecast <- predict(m, future)
tail(forecast[c('ds', 'yhat', 'yhat_lower', 'yhat_upper')])
forecast
tail(forecast[c('ds', 'yhat', 'yhat_lower', 'yhat_upper')])
plot(m,forecast)
prophet_plot_components(m,forecast)
q()
bitcoin = read.csv("/home/victor/dev/in1167/daily-bitcoin-market-price-2010.csv")
bitcoin
bitcoin.ts = ts(bitcoin[2], frequency=365, start=c(2010,8,17),end=c(2016,7,6))
bitcoin.ts
bitcoin.ts = ts(bitcoin[2], frequency=365, start=c(2010,8,17))
bitcoin.ts
bitcoin[2]
inds <- seq(as.Date("2010-08-17"), as.Date("2016-07-07"), by = "day")
plot(bitcoin.ts)
bitcoin.decompose = decompose(bitcoin.ts)
plot(bitcoin.decompose)
png('bitcoin-ts.png',width=860)
plot(bitcoin.ts)
dev.off()
png('bitcoin-decompose.png',width=860)
plot(bitcoin.decompose)
dev.off()
auto.arima(bitcoin.ts, seasonal=FALSE)
library(tseries)
library(forecast)
library(stats)
auto.arima(bitcoin.ts, seasonal=FALSE)
auto.arima(bitcoin.ts)
bitcoin.arima = arima(bitcoin.ts, order=c(5,1,2))
bitcoin.forecast = forecast(bitcoin.arima, h=120)
plot(bitcoin.forecast)
bitcoin._arima = auto.arima(ts(bitcoin.ts[1:1963], start=(2010,08,17),frequency=365))
bitcoin._arima = auto.arima(ts(bitcoin.ts[1:1963], start=c(2010,08,17),frequency=365))
bitcoin._forecast = forecast(bitcoin._arima)
bitcoin._forecast = forecast(bitcoin._arima, h=189)
plot(bitcoin._forecast)
lines(bitcoin.ts)
png('bitccoin-forecast.png',width=860)
plot(bitcoin._forecast)
lines(bitcoin.ts)
dev.off()
adf.test(bitcoin, alternative="stationary", k=1)
adf.test(bitcoin.ts, alternative="stationary", k=1)
bitcoin.diff = diff(bitcoin.ts, differences=1)
adf.test(bitcoin.diff, alternative="stationary", k=1)
png('bitcoin-diff.png',width=860)
plot(bitcoin.diff)
dev.off()
q()
car_ = read.csv("/home/victor/dev/in1167/monthly-car-sales-in-quebec-1960.csv")
car_ = read.csv("/home/victor/dev/in1167/monthly-car-sales-in-quebec-1960.csv",nrows=84)
car_$y = log(car_$Monthly.car.sales.in.Quebec.1960.1968)
car_$ds = redate(car_$Month)
m = prophet(car_)
library(prophet)
m = prophet(car_)
future = make_future_dataframe(m, periods=24)
forecast = predict(m,future)
plot(forecast)
plot(m,forecast)
lines(log(car.ts))
plot(m,forecast)
prophet_plot_components(m,forecast)
plot(m,forecast)
plot(m,log(car.ts))
m = prophet(car_)
plot(m,forecast)
plot(log(car.ts))
plot(m,forecast)
forecast
plot(m,forecast)
plot(m,forecast)
length
m = prophet(car_)
plot(m,forecast)
m = prophet(car)
plot(m,forecast)
future = make_future_dataframe(m, periods=365*2)
forecast = predict(m,future)
plot(m,forecast)
future = make_future_dataframe(m, periods=365*2)
forecast = predict(m,future)
plot(m,forecast)
m = prophet(car)
plot(m,forecast)
png('car-prophet.png',width=860)
plot(m,forecast)
dev.off()
expenses_ = read.csv("/home/victor/dev/in1167/monthly-expenses-in-brasil-2009.csv",nrows=78)
expenses_$y = log(expenses_$Monthly.expenses.by.congressman.in.Brasil.2009.2016)
expenses_$ds = redate(expenses_$Month)
m = prophet(expenses_)
future = make_future_dataframe(m, periods=8*31)
forecast = predict(m,future)
plot(m,forecast)
expenses$y = log(expenses$Monthly.expenses.by.congressman.in.Brasil.2009.2016)
expenses$ds = redate(expenses$Month)
m = prophet(expenses)
plot(m,forecast)
png('expenses-prophet.png',width=860)
plot(m,forecast)
dev.off()
bitcoin
bitcoin$ds = redate(bitcoin$Date)
bitcoin$y = log(bitcoin$Bitcoin.market.price..USD..2010.2016)
bitcoin = read.csv("/home/victor/dev/in1167/daily-bitcoin-market-price-2010.csv",nrows=1963)
bitcoin = read.csv("/home/victor/dev/in1167/daily-bitcoin-market-price-2010.csv")
bitcoin$y = log(bitcoin$Bitcoin.market.price..USD..2010.2016)
bitcoin$ds = redate(bitcoin$Date)
bitcoin_ = read.csv("/home/victor/dev/in1167/daily-bitcoin-market-price-2010.csv",nrows=1963)
bitcoin_$y = log(bitcoin_$Bitcoin.market.price..USD..2010.2016)
bitcoin_$ds = redate(bitcoin_$Date)
m = prophet(bitcoin_)
bitcoin$ds = bitcoin$Date
bitcoin_$ds = bitcoin_$Date
m = prophet(bitcoin_)
future = make_future_dataframe(m, periods=190)
forecast = predict(m,future)
plot(m,forecast)
m = prophet(bitcoin)
plot(m,forecast)
png('bitcoin-prophet.png',width=860)
plot(m,forecast)
dev.off()
q()
source('dlmScript.R')
source('dlmScript.R', local=TRUE)
source('dlmScript.R', local=TRUE)
source('dlmScript.R', local=TRUE)
source('dlmScript.R', local=TRUE)
source('dlmScript.R', local=TRUE)
source('dlmScript.R', local=TRUE)
source('dlmScript.R', local=TRUE)
source('dlmScript.R', local=TRUE)
source('dlmScript.R', local=TRUE)
source('dlmScript.R', local=TRUE)
source('dlmScript.R', local=TRUE)
source('dlmScript.R', local=TRUE)
source('dlmScript.R', local=TRUE)
source('dlmScript.R', local=TRUE)
source('dlmScript.R', local=TRUE)
library(dlmScript.R)
source('dlmScript.R', local=TRUE)
source('dlmScript.R', local=TRUE)
source('dlmScript.R', local=TRUE)
source('dlmScript.R', local=TRUE)
main(car_.ts, car.ts, c(1960,1), 24, "-", "Log car sales")
car_.ts
car_
car_.ts = ts(car_$Monthly.car.sales.in.Quebec.1960.1968, start=c(1960,1), frequency=12)
car.ts
car_.ts
main(car_.ts, car.ts, c(1960,1), 24, "-", "Log car sales")
expenses_
expenses_.ts = ts(expenses_, start=(2009,7), frequency=12)
expenses_.ts = ts(expenses_, start=c(2009,7), frequency=12)
expenses_.ts = ts(expenses_$Monthly.expenses.by.congressman.in.Brasil.2009.2016, start=c(2009,7), frequency=12)
bitcoin_.ts = ts(bitcoin_$Bitcoin.market.price..USD..2010.2016, start=c(2010,8,17), frequency=365)
main(expenses_.ts, expenses.ts, c(2009,7), 8, "-", "Log congressman expenses")
main(bitcoin_.ts, bitcoin.ts, c(2010,8,17), 190, "-", "Log bitcoin market price")
main(bitcoin_.ts, bitcoin.ts, c(2010,8), 190, "-", "Log bitcoin market price")
q()
source('dlmScript.R')
main(car_.ts, car.ts, c(1960,1), 24, "-", "Log car sales")
main(expenses_.ts, expenses.ts, c(2009,7), 8, "-", "Log congressman expenses")
main(bitcoin_.ts, bitcoin.ts, c(2010,8), 190, "-", "Log bitcoin market price")
source('dlmScript.R')
main(bitcoin_.ts, bitcoin.ts, c(2010,8), 190, "-", "Log bitcoin market price")
main(expenses_.ts, expenses.ts, c(2009,7), 8, "-", "Log congressman expenses")
main(car_.ts, car.ts, c(1960,1), 24, "-", "Log car sales")
main(bitcoin_.ts, bitcoin.ts, c(2010,8), 190, "-", "Log bitcoin market price")
q()
